---
title: "Data"
author: "Rubén A. Rodríguez Barrón"
date: "4/26/2021"
output: pdf_document
---

```{r}
knitr::opts_chunk$set(echo = TRUE, error = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(readstata13)
library(skimr)
library(psych)
```

# Data

This is the file where we will clean the data from **anes_timeseries_2016_Stata13.dta**. The raw data can be accessed [here](https://electionstudies.org/data-center/2016-time-series-study/).

The data frame *clean.rds* should be used in all working files of the project. 

```{r}
raw <- read.dta13("anes_timeseries_2016_Stata13.dta")
```

```{r}
clean <- raw %>% 
  #Please add your lines in ANES order
  select(ideology = V161126,
         party = V161158x,
         race = V161310x,
         gender = V161342,
         radio_all_things_considered	=	V161431,
         radio_marketplace	=	V161432,
         radio_the_glenn_beck_program	=	V161433,
         radio_the_mark_levin_show	=	V161434,
         radio_the_savage_nation	=	V161435,
         radio_fresh_air	=	V161436,
         radio_the_hugh_hewitt_show	=	V161437,
         radio_the_thom_hartmann_program	=	V161438,
         radio_joe_madison	=	V161439,
         radio_the_mike_gallagher_show	=	V161440,
         radio_the_bill_handel_show	=	V161441,
         radio_the_schnitt_show	=	V161442,
         radio_no_radio	=	V161443,
         ft_obama	=	V161092,
         ft_bill_clinton	=	V161093,
         ft_democratic_party	=	V161095,
         ft_republican_party	=	V161096,
         ft_clinton	=	V162078,
         ft_trump	=	V162079,
         ft_johnson	=	V162080,
         ft_stein	=	V162081,
         ft_kaine	=	V162091,
         ft_pence	=	V162092,
         ft_john_roberts	=	V162093,
         ft_pope_francis	=	V162094,
         ft_christian_fundamentalists = V162095,
         ft_feminists = V162096,
         ft_liberals = V162097,
         ft_labor_unions = V162098,
         ft_poor_people = V162099,
         ft_big_business = V162100,
         ft_conservatives = V162101,
         ft_supreme_court = V162102,
         ft_gay_lesbian = V162103,
         ft_congress = V162104,
         ft_rich_people = V162105,
         ft_muslims = V162106,
         ft_christians = V162107,
         ft_jews = V162108,
         ft_tea_party = V162109,
         ft_police= V162110,
         ft_transgender_people = V162111,
         ft_scientists = V162112,
         ft_blm = V162113) %>% 
  # Recoding ideology
  mutate(ideology = dplyr::recode(ideology,
                        `-9` = NA_real_,
                        `-8` = NA_real_,
                        `99` = NA_real_)) %>% 
  # Recoding party
  mutate(party = dplyr::recode(party,
                        `-9` = NA_real_,
                        `-8` = NA_real_)) %>% 
  # Recoding race
  mutate(race = dplyr::recode(race,
                        `-9` = NA_real_)) %>% 
  # Recoding gender
  mutate(gender = dplyr::recode(gender,
                        `-9` = NA_real_,
                        `3`  = NA_real_)) %>% 
  # Recoding tv
  mutate_at(vars(contains("tv_")), funs(if_else(.<0,NA_real_,.))) %>% 
  # Recoding radio
  mutate_at(vars(contains("radio_")), funs(if_else(.<0,NA_real_,.))) %>% 
  # Recoding web
  mutate_at(vars(contains("web_")), funs(if_else(.<0,NA_real_,.))) %>%
  # Recoding thermometers
  mutate_at(vars(contains("ft_")), funs(if_else(.<0 | .>100, NA_real_,.)))
```

```{r}
# Set factors for ideology
clean$ideology <- factor(clean$ideology, labels=c("Extremely Liberal", "Liberal", "Slightly Liberal", "Moderate", "Slightly Conservative", "Conservative", "Extremely Conservative"))

# Set factors for party
clean$party <- factor(clean$party, labels=c("Strong Democrat", "Democrat", "Lean Democrat", "Independent", "Lean Republican", "Republican", "Strong Republican"))
```

```{r}
# Save a single object to a file
saveRDS(clean, "clean.rds")
```

